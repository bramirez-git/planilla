import $ from"jquery";import bootstrap from"bootstrap";import Util from"./util";const NAME="aceAside";const VERSION="3.0.1";const DATA_KEY="ace.aside";const EVENT_KEY=`.${DATA_KEY}`;const Event={SHOW:`show${EVENT_KEY}`,HIDE:`hide${EVENT_KEY}`};const DefaultType={placement:"string",fade:"boolean",autohide:"(boolean|number)",dismiss:"boolean",blocking:"boolean",backdrop:"(boolean|string)",container:"boolean",belowNav:"boolean",aboveNav:"boolean",width:"(boolean|number)",height:"(boolean|number)",scroll:"(boolean|string)"};const Default={placement:"center",fade:false,autohide:false,dismiss:false,blocking:false,backdrop:false,container:false,belowNav:false,aboveNav:false,width:false,height:false,scroll:"body"};class Aside{constructor(element,config){this._config=this._getConfig(config);this._element=element;this.$element=$(element);this._init(this._config)}static get VERSION(){return VERSION}static get DefaultType(){return DefaultType}static get Default(){return Default}_init(config){this._setPlacement(config.placement);this._element.classList.add("ace-aside");if(!config.blocking){this._element.classList.add("modal-nb");this.$element.attr("data-backdrop","false").data("backdrop",false)}else{if(config.backdrop){this.$element.attr("data-backdrop-bg",config.backdrop)}this.$element.attr("data-backdrop","true").data("backdrop",true)}if(config.dismiss)this._element.classList.add("modal-dismiss");if(config.fade){this._element.classList.add("aside-fade","fade")}if(config.belowNav)this._element.classList.add("aside-below-nav");if(config.aboveNav)this._element.classList.add("aside-above-nav");if(config.extraClass)this._element.classList.add(...config.extraClass.split(" "));if(config.container){this._element.classList.add("container");var bdc=document.querySelector(".body-container");if(bdc!==null&&bdc.classList.contains("container-plus")){this._element.classList.add("container-plus")}}if(config.width){this.$element.find(".modal-dialog").css("width",isNaN(config.width)?config.width:this._config.width+"px")}if(config.height){this.$element.find(".modal-dialog").css("height",isNaN(config.height)?config.height:this._config.height+"px")}this.$element.off("shown.bs.modal.autohide");if(config.autohide){const This=this;this.$element.on("shown.bs.modal.autohide",function(){setTimeout(function(){This.hide()},config.autohide)})}}_setPlacement(placement="center"){const placementMap={t:"aside-top",top:"aside-top",tc:"aside-top aside-c",tr:"aside-top aside-r",tl:"aside-top aside-l",b:"aside-bottom",bottom:"aside-bottom",bc:"aside-bottom aside-c",br:"aside-bottom aside-r",bl:"aside-bottom aside-l",r:"aside-right",right:"aside-right",rc:"aside-right aside-m",l:"aside-left",left:"aside-left",lc:"aside-left aside-m",c:"aside-center",center:"aside-center"};placement=placement||"c";const className=placementMap[placement]||"aside-center";if(placement==="c"||placement==="center"){this._config.fade=true;this._element.classList.remove("container")}this._element.className=this._element.className+" "+className}show(){const showEvent=new $.Event(Event.SHOW);this.$element.trigger(showEvent);if(showEvent.isDefaultPrevented()){return}this.$element.modal("show")}hide(){const hideEvent=new $.Event(Event.HIDE);this.$element.trigger(hideEvent);if(hideEvent.isDefaultPrevented()){return}this.$element.modal("hide")}_getConfig(config){config={...Default,...typeof config==="object"&&config?config:{}};if(typeof bootstrap!=="undefined"){bootstrap.Util.typeCheckConfig(NAME,config,this.constructor.DefaultType)}return config}static _jQueryInterface(config){return this.each(function(){const $this=$(this);let data=$this.data(DATA_KEY);const _config={...Default,...$(this).data(),...typeof config==="object"&&config?config:{}};if(!data){data=new Aside(this,_config);$this.data(DATA_KEY,data)}if(typeof config==="string"){if(typeof data[config]==="undefined"){throw new TypeError(`No method named "${config}"`)}data[config]()}})}static _HandleAside(){var visibleModalSelector=".modal.show:not(.modal-nb)";var dismissEventId=0;$(".ace-aside.modal-nb").attr("data-backdrop","false").data("backdrop",false);$(document).on("show.bs.modal",".modal",function(e){if(e.isDefaultPrevented())return;var modal=this;if(modal.classList.contains("modal-nb")){if($(visibleModalSelector).length===0){document.body.classList.add("modal-nb")}}else{if(!modal.classList.contains("ace-aside")){modal.style.display="block";if(modal.scrollHeight>modal.clientHeight)document.body.classList.add("modal-scroll");var scrollbars=Util.getScrollbarInfo();if(scrollbars.width===0)document.body.classList.add("scrollbar-w0");modal.style.display=""}document.body.style.setProperty("--modal-padding",window.innerWidth-document.body.scrollWidth+"px");var backdropBg=$(modal).attr("data-backdrop-bg");if(backdropBg){setTimeout(function(){$(".modal-backdrop").addClass(backdropBg)},0)}var blur=modal.getAttribute("data-blur");if(blur!==null&&window.CSS){if(window.CSS.supports("filter","none")){var bodyContainer=document.querySelector(".body-container");if(bodyContainer!==null){document.body.classList.add("modal-blur");bodyContainer.style.filter="blur("+blur+")";var modalParent=modal.parentNode;var modalSibling=modal.nextSibling;$(modal).appendTo("body").one("hidden.bs.modal.blur",function(){modalParent.insertBefore(modal,modalSibling);document.body.classList.remove("modal-blur");bodyContainer.style.filter=""})}}}}}).on("shown.bs.modal",".modal",function(e){var modal=this;if(modal.classList.contains("modal-nb")){document.body.classList.remove("modal-nb");if($(visibleModalSelector).length===0){document.body.classList.remove("modal-open");document.body.style.paddingRight=""}if(modal.classList.contains("modal-dismiss")||modal.getAttribute("data-dismiss")==="true"){modal.setAttribute("data-dismiss-event-id",++dismissEventId);$(document).on("mouseup.aside-dismiss."+dismissEventId,function(e){if(!$.contains(modal,e.target)){setTimeout(function(){$(modal).modal("hide")},0)}})}}}).on("hidden.bs.modal",".modal",function(){if($(visibleModalSelector).length===0)document.body.style.paddingRight="";else document.body.classList.add("modal-open");if(!this.classList.contains("modal-nb")){document.body.classList.remove("modal-scroll");document.body.classList.remove("scrollbar-w0")}if(this.classList.contains("modal-dismiss")||this.getAttribute("data-dismiss")==="true"){var eid=this.getAttribute("data-dismiss-event-id");$(document).off(".aside-dismiss."+eid)}});$(".modal.show").modal("show")}}if(typeof $!=="undefined"){Aside._HandleAside();const JQUERY_NO_CONFLICT=$.fn[NAME];$.fn[NAME]=Aside._jQueryInterface;$.fn[NAME].Constructor=Aside;$.fn[NAME].noConflict=()=>{$.fn[NAME]=JQUERY_NO_CONFLICT;return Aside._jQueryInterface}}export default Aside;