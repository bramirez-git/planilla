import $ from"jquery";import Util from"./util";class Basic{static _HandleBasics(){Basic._handleAlerts();Basic._handleDropdowns();Basic._handleNavbar();Basic._handleTabScrollAndSwipe();Basic._handleScrollTop();Basic._handleSticky();Basic._handleOther();$(document.body).addClass("is-document-loaded")}static _handleAlerts(){$(document).on("close.bs.alert.alert-collapse",".alert.alert-collapse",function(e){e.preventDefault();$(this).wrap('<div class="collapse show alert-collapse"></div>').parent().collapse("hide").one("hidden.bs.collapse.alert-collapse",function(){$(this).remove()})})}static _handleDropdowns(){var _dismissDropdown=function(){var menu=$(this).closest(".dropdown-menu");var dropdown=menu.parent();var toggle=dropdown.find("[data-toggle=dropdown]");toggle.dropdown("hide");menu.removeClass("show");dropdown.removeClass("show")};$(document).on("click","[data-dismiss=dropdown]",function(e){e.preventDefault();_dismissDropdown.call(e.target)});$(document).on("submit",".dropdown-menu form[data-submit=dismiss]",function(e){e.preventDefault();_dismissDropdown.call(e.target)});$(document).on("click.dropdown-clickable",".dropdown-clickable",function(e){e.stopImmediatePropagation()});$(document).on("shown.bs.dropdown",".dropdown.dd-backdrop",function(e){if(window.getComputedStyle(this,":before").display==="none")return;var scrollbarInfo=Util.getScrollbarInfo();if(scrollbarInfo.width===0){document.body.classList.add("mob-dropdown-body")}this.classList.add("backdrop-shown");$(this).one("hidden.bs.dropdown",function(e){document.body.classList.remove("mob-dropdown-body");this.classList.remove("backdrop-shown")})})}static _handleNavbar(){$(document).on("click",".navbar-backdrop.collapse.show",function(e){if(e.target===this)$(this).collapse("hide")});$(document).on("submit",".navbar-collapse.show form[data-submit=dismiss]",function(e){e.preventDefault();$(this).closest(".navbar-collapse").collapse("hide")});$(document).on("shown.bs.dropdown",".navbar .dropdown",function(){$(this).find(".autofocus").focus()}).on("shown.bs.collapse",".navbar-collapse",function(){$(this).find(".autofocus").focus();if(this.classList.contains("navbar-backdrop")){var scrollbarInfo=Util.getScrollbarInfo();if(scrollbarInfo.width===0){document.body.classList.add("mob-navbar-body")}}}).on("hidden.bs.collapse",function(){document.body.classList.remove("mob-navbar-body")}).on("show.bs.collapse",function(){$(".navbar-collapse.show").css("transition-duration","1ms").collapse("hide").css("transition-duration","")});var _adjustDropdown=function(){var isRTL=Util.isRTL();var isRightAligned=this.classList.contains("dropdown-menu-right");var _dir=!isRightAligned?!isRTL?"left":"right":!isRTL?"right":"left";var prop="margin-"+_dir;this.style.removeProperty(prop);var moveBy=0;var rect=this.getBoundingClientRect();if(rect.left<0){moveBy=parseInt(-1*rect.left)+5}else{var sw=document.body.scrollWidth;if(rect.right>sw){moveBy=parseInt(sw-rect.right-5)}}if(moveBy<5)return;if(isRightAligned)moveBy*=-1;this.style.setProperty(prop,moveBy+"px","important")};var _closest="closest"in document.documentElement;$(document).on("transitionstart.adjust",".navbar .dropdown-mega .dropdown-menu",function(ev){if(ev.target!==this||ev.originalEvent.propertyName!=="transform")return;_adjustDropdown.call(this)}).on("shown.bs.dropdown",".navbar .dropdown",function(){if(this.classList.contains("dropdown-mega")){var dropdown=this.querySelector('.dropdown-menu[data-display="static"]');if(dropdown!==null)_adjustDropdown.call(dropdown)}if(_closest){var navbar=this.closest(".navbar");if(this.classList.contains("backdrop-shown"))navbar.classList.add("navbar-modal");else navbar.classList.add("navbar-open")}}).on("hidden.bs.dropdown",".navbar .dropdown",function(){if(_closest){var navbar=this.closest(".navbar");navbar.classList.remove("navbar-open");navbar.classList.remove("navbar-modal")}})}static _handleTabScrollAndSwipe(){var _firefox="MozAppearance"in document.documentElement.style;var _scrollIntoView=function(smooth=true){var li=this.parentNode;var nav=li.parentNode;var navClientWidth=nav.clientWidth;var navScrollWidth=nav.scrollWidth;if(navScrollWidth<=navClientWidth)return;var isRTL=Util.isRTL();var _scrollLeft;if(!isRTL){_scrollLeft=li.offsetLeft-(navClientWidth-li.clientWidth)/2}else{if(!_firefox){_scrollLeft=navScrollWidth-navClientWidth+li.offsetLeft-(navClientWidth-li.clientWidth)/2}else{_scrollLeft=li.offsetLeft-(navClientWidth-li.clientWidth)/2}}_scrollLeft=_scrollLeft|0;smooth=!Util.isReducedMotion()&&smooth===true;try{nav.scrollTo({top:0,left:_scrollLeft,behavior:smooth?"smooth":"auto"});if(_firefox&&_scrollLeft<nav.scrollLeft){setTimeout(function(){nav.scrollTo({top:0,left:_scrollLeft,behavior:smooth?"smooth":"auto"})},0)}}catch(e){nav.scrollLeft=_scrollLeft}};var aceTabScroll=function(){var This=this.get(0);var active=This.querySelector(".active");if(active){if(!_firefox){_scrollIntoView.call(active,false)}else{setTimeout(()=>{This.scrollLeft=1;_scrollIntoView.call(active,false)},500)}}this.on("click","a",function(){_scrollIntoView.call(this)})};$.fn.aceTabScroll=aceTabScroll;$(".nav-tabs-scroll").each(function(){$(this).aceTabScroll()});var aceTabSwipe=function(){var allowedDir=$(this).attr("data-swipe")||null;this.on("touchstart",".tab-pane",function(ev){if(!this.classList.contains("active"))return;var curPane=this;var isRTL=Util.isRTL();var initialTransform=!isRTL?"translateX(100%)":"translateX(-100%)";var touches=ev.originalEvent.changedTouches[0];var swipeDir=0;var x1=touches.pageX;var y1=touches.pageY;var t1=Date.now();var lastX=0;var curDir=0;var paneWidth=curPane.clientWidth;var siblingPane=null;function _dismiss(){$(curPane).off("touchmove touchend touchcancel");curPane.style.transform="";curPane.classList.remove("tab-swiping");if(siblingPane){siblingPane.style.transform="";siblingPane.classList.remove("tab-swiping")}}function _reset(sibling){sibling.style.transform="";sibling.style.transitionDuration="0ms";sibling.classList.remove("tab-swiping");sibling.offsetHeight;sibling.style.transitionDuration=""}$(this).on("touchmove",function(ev){var touches=ev.changedTouches[0];var newX=touches.pageX;var newY=touches.pageY;lastX=newX;if(swipeDir===0){var diffY=Math.abs(y1-newY);var diffX=Math.abs(x1-newX);if(diffY>diffX){swipeDir=2;$(curPane).off("touchmove")}else if(diffX>10){swipeDir=1}}if(swipeDir!==1)return;var moveX=parseInt(x1-newX);var newDir=0;if((allowedDir===null||allowedDir==="left")&&(!isRTL&&moveX>0||isRTL&&moveX<0))newDir=1;else if((allowedDir===null||allowedDir==="right")&&(!isRTL&&moveX<0||isRTL&&moveX>0))newDir=-1;if(newDir!==0&&newDir!==curDir){if(siblingPane!==null)_reset(siblingPane);curDir=newDir;var targetPane=curPane.getAttribute("data-swipe-"+(curDir===1?"next":"prev"));if(targetPane)targetPane=document.querySelector(targetPane);siblingPane=targetPane||(curDir===1?curPane.nextElementSibling:curPane.previousElementSibling);if(siblingPane===null||siblingPane===curPane){curDir=0}else{curPane.classList.add("tab-swiping");siblingPane.classList.add("tab-swiping")}}var moveXabs=Math.abs(moveX);if(curDir!==0&&moveXabs<paneWidth+24){curPane.style.transform=initialTransform+" translateX("+-1*moveX+"px)";siblingPane.style.transform="translateX("+-1*moveX+"px)"}else if(curDir===0&&moveXabs<24){curPane.style.transform=initialTransform+" translateX("+-1*moveX+"px)"}}).on("touchend touchcancel",function(ev){var touches=ev.originalEvent.changedTouches[0]||null;var x2=touches!==null?touches.pageX:lastX;var t2=Date.now();var diff=Math.abs(x2-x1);_dismiss();if(curDir!==0&&swipeDir===1&&(diff>paneWidth/4||diff>100||diff>paneWidth/6&&t2-t1<300)){siblingPane.classList.add("active","show");curPane.classList.remove("active","show");var id1=curPane.id;var id2=siblingPane.id;$('[href="#'+id1+'"],[data-target="#'+id1+'"]').removeClass("active");var newActive=$('[href="#'+id2+'"],[data-target="#'+id2+'"]');newActive.addClass("active");if(newActive.length>0){_scrollIntoView.call(newActive.get(0))}}})})};$.fn.aceTabSwipe=aceTabSwipe;if("ontouchstart"in window){$('.tab-sliding:not([data-swipe="none"])').each(function(){$(this).aceTabSwipe()})}}static _handleScrollTop(){var _scrollBtn=document.querySelector(".btn-scroll-up");if(_scrollBtn===null||_scrollBtn.offsetParent===null)return;var showScrollbtn=function(){_scrollBtn.classList.add("scroll-btn-visible")};var hideScrollBtn=function(){_scrollBtn.classList.remove("scroll-btn-visible")};var scrollToTop=function(){try{var smoothScroll=!Util.isReducedMotion();window.scroll({top:0,behavior:smoothScroll?"smooth":"auto"})}catch(e){window.scroll(0,0)}};var _modernBrowser="IntersectionObserver"in window;_scrollBtn.addEventListener("click",function(e){e.preventDefault();if(_modernBrowser)hideScrollBtn();scrollToTop()});if(!_modernBrowser){showScrollbtn()}else{var _scrollBtnObserve=document.createElement("DIV");_scrollBtnObserve.classList.add("scroll-btn-observe");document.body.appendChild(_scrollBtnObserve);const observer=new window.IntersectionObserver(([entry])=>{var isObserverOut=entry.intersectionRatio<1&&entry.boundingClientRect.bottom<0;if(isObserverOut){showScrollbtn()}else{hideScrollBtn()}},{threshold:[1],delay:100});observer.observe(_scrollBtnObserve)}}static _handleSticky(){if(!window.IntersectionObserver)return;const observer=new window.IntersectionObserver(([entry])=>{var isSticky=entry.intersectionRatio<1&&entry.boundingClientRect.bottom<0;var stickyNav=entry.target.parentElement;if(isSticky&&!stickyNav.classList.contains("sticky-nav")){var pos=window.getComputedStyle(stickyNav).position;if(!(pos==="sticky"||pos==="-webkit-sticky"))isSticky=false}const evt=new window.CustomEvent("sticky-change",{detail:{isSticky:isSticky}});stickyNav.dispatchEvent(evt)},{threshold:[1],delay:100});var aceStickyNav=function(){var stickyEl=this.get(0);var observedChild=document.createElement(stickyEl.tagName==="UL"?"LI":"DIV");observedChild.classList.add("sticky-trigger");stickyEl.insertBefore(observedChild,stickyEl.firstChild);observer.observe(observedChild);setTimeout(function(){if(observedChild.getBoundingClientRect().bottom<0){var isSticky=true;if(isSticky&&!stickyEl.classList.contains("sticky-nav")){var pos=window.getComputedStyle(stickyEl).position;if(!(pos==="sticky"||pos==="-webkit-sticky"))isSticky=false}const evt=new window.CustomEvent("sticky-change",{detail:{isSticky:isSticky,initialCheck:true}});stickyEl.dispatchEvent(evt)}},200)};$.fn.aceStickyNav=aceStickyNav;$('[class*="sticky-nav"]').each(function(){$(this).aceStickyNav()})}static _handleOther(){$(".input-floating-label input").each(function(){if(this.value!=="")this.classList.add("has-content");else this.classList.remove("has-content")});$(document).on("focusout",".input-floating-label input",function(e){if(this.value!=="")this.classList.add("has-content");else this.classList.remove("has-content")})}}if(typeof $!=="undefined"){Basic._HandleBasics()}export default Basic;