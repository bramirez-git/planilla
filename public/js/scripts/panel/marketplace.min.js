$(document).ready(function(){var frmMarketplace=$("#frm-marketplaces");frmMarketplace.validate({errorElement:"div",errorClass:"help-block",focusInvalid:false,rules:{nombre_modulo:{required:true},precio:{required:true},descripcion:{required:true}},messages:{nombre_modulo:{required:"Este campo es requerido."},precio:{required:"Este campo es requerido."},descripcion:{required:"Este campo es requerido."}},errorElement:"span"});$("#registrar").on("click",function(evt){evt.preventDefault();var value=$("#estado").prop("checked")?1:2;$("#estado").prop("checked",$(this).prop("checked"));$("#valor_estado").val(value);if(frmMarketplace.valid()){confirmar("","¿Desea guardar el producto?","question",function(){waitingDialog.show();frmMarketplace.submit()})}else{return false}});$("#actualizar").on("click",function(evt){evt.preventDefault();var value=$("#estado").prop("checked")?1:2;$("#estado").prop("checked",$(this).prop("checked"));$("#valor_estado").val(value);if(frmMarketplace.valid()){confirmar("","¿Desea actualizar el producto?","question",function(){waitingDialog.show();frmMarketplace.submit()})}else{return false}});$(".eliminar-producto").on("click",function(event){event.preventDefault();var formId=$(this).data("form-id");confirmar("","¿Está seguro que desea eliminar el producto?","question",function(){waitingDialog.show();$("#frm-destroy-marketplace-"+formId).submit()})});$("#precio").on("input",function(){var $t=$(this);var inputValue=$t.val();var cursorPosition=$t[0].selectionStart;var validatedValue=inputValue.replace(/[^\d.]/g,"");var parts=validatedValue.split(".");if(parts.length>2){validatedValue=parts[0]+"."+parts.slice(1).join("")}if(validatedValue.charAt(0)==="."){validatedValue=validatedValue.slice(1)}$t.val(validatedValue);if(cursorPosition<$t.val().length){$t[0].setSelectionRange(cursorPosition,cursorPosition)}});var textareaDescripcion=$("#descripcion");ajustarAltura(textareaDescripcion);textareaDescripcion.on("input",function(){ajustarAltura($(this))});function ajustarAltura(elemento){elemento.css("height","auto");elemento.css("height",elemento.prop("scrollHeight")+"px")}$(function(){var descarga_marketplace=$("#descarga_excel_marketplace");descarga_marketplace.on("click",function(event){event.preventDefault();waitingDialog.show();var valor_busqueda=$("#buscar").val();var orden=$('[name="orden"]').val();var tipo_orden=$('[name="tipo_orden"]').val();var datos=descarga_marketplace.serialize();datos+="&buscar="+valor_busqueda;datos+="&orden="+orden;datos+="&tipo_orden="+tipo_orden;$.ajax({type:"POST",url:base_path+"/panelAdministracion/descargar_excel_marketplace",data:datos,success:function(response){if(response.success){var link=document.createElement("a");link.href=response.url;link.download="Lista_de_marketplace.txt";link.click();waitingDialog.hide();mostrarAlertaExito(response.message)}else{waitingDialog.hide();mensaje_swal("error",response.message)}},error:function(error){waitingDialog.hide();mensaje_swal("error",error)}})})})});